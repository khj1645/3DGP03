### 지형 테셀레이션 구현 최종 계획

**Step 1: `CHeightMapGridMesh` 수정 (in `Mesh.cpp`, `Mesh.h`)**
*   **목표:** 기존 정점 생성 로직은 유지하되, 인덱스 버퍼만 테셀레이션을 위한 '쿼드 패치' 구조로 변경하여 안정성을 확보하고 수정 범위를 최소화합니다.
*   **수행 작업:**
    1.  **정점 생성 유지:** `CHeightMapGridMesh` 생성자에서 `(nWidth * nLength)` 개수의 정점(위치, 색상, UV)을 생성하는 기존 코드는 그대로 둡니다.
    2.  **인덱스 버퍼 재구성:** 기존의 삼각형 스트립(Triangle Strip) 인덱스 생성 로직을 다음의 쿼드 패치(Quad Patch) 로직으로 교체합니다.
        *   `m_d3dPrimitiveTopology` 멤버 변수를 `D3D_PRIMITIVE_TOPOLOGY_4_CONTROL_POINT_PATCHLIST`로 설정합니다.
        *   전체 지형 블록을 순회하며, 각 사각형을 구성하는 4개의 정점 인덱스를 순서대로 (`v0, v1, v2, v3`) 인덱스 버퍼에 저장합니다.
    3.  **렌더링 설정 변경:** `CHeightMapGridMesh::Render` 함수에서 `IASetPrimitiveTopology`를 호출할 때 `D3D_PRIMITIVE_TOPOLOGY_4_CONTROL_POINT_PATCHLIST`가 사용되도록 확인합니다.

**Step 2: 테셀레이션 셰이더 구현 (in `Shaders.hlsl`)**
*   **목표:** 정점 데이터를 받아 동적으로 지형 폴리곤을 생성하고 LOD를 적용하는 셰이더 파이프라인(VS-HS-DS-PS)을 구축합니다.
*   **수행 작업:**
    1.  **정점 셰이더 (`VSTerrain`) 수정:** 월드-뷰-프로젝션 변환을 제거하고, 입력된 제어점의 속성(위치, UV 등)을 헐 셰이더로 그대로 전달하는 단순한 패스스루(pass-through) 함수로 변경합니다.
    2.  **헐 셰이더 (HS) 신규 작성:**
        *   **상수 함수 (`HSTerrainConstant`):** 패치 중앙과 카메라의 거리를 계산합니다. 이 거리를 바탕으로 미리 정의된 최소/최대 거리 및 테셀레이션 계수를 사용하여 패치를 얼마나 나눌지 결정하는 '테셀레이션 계수'를 출력합니다. (LOD의 핵심)
        *   **메인 함수 (`HSTerrain`):** 제어점 데이터를 도메인 셰이더로 전달합니다.
    3.  **도메인 셰이더 (DS) 신규 작성 (`DSTerrain`):**
        *   헐 셰이더에서 생성된 새 정점의 보간 좌표와 제어점 데이터를 입력받습니다.
        *   제어점 속성을 보간하여 새 정점의 XZ 월드 좌표와 UV 좌표를 계산합니다.
        *   **높이 맵 텍스처를 샘플링**하여 새 정점의 Y(높이) 값을 계산합니다.
        *   계산된 최종 월드 좌표를 월드-뷰-프로젝션 행렬과 곱하여 최종 클립 공간 위치(`SV_Position`)를 계산합니다.
        *   최종 계산된 속성(위치, UV 등)을 픽셀 셰이더로 전달합니다.
    4.  **픽셀 셰이더 (`PSTerrain`) 유지:** 기존과 거의 동일하게, 도메인 셰이더에서 보간된 데이터를 받아 텍스처를 입히는 역할을 수행합니다.

**Step 3: `CTerrainShader` 수정 (in `Shader.cpp`, `Shader.h`)**
*   **목표:** 테셀레이션 파이프라인을 사용하는 새로운 파이프라인 상태 객체(PSO)를 정의하고 생성합니다.
*   **수행 작업:**
    1.  **신규 PSO 정의:** `CreateShader` 함수 내에 테셀레이션용 `D3D12_GRAPHICS_PIPELINE_STATE_DESC`를 새로 정의하고 `ZeroMemory`로 초기화합니다.
    2.  **셰이더 할당:** 위에서 수정한 `VSTerrain`과 새로 작성한 `HSTerrain`, `DSTerrain` 셰이더를 컴파일하여 PSO의 `VS`, `HS`, `DS` 멤버에 각각 할당합니다.
    3.  **토폴로지 설정:** PSO 설명자의 `PrimitiveTopologyType`을 `D3D12_PRIMITIVE_TOPOLOGY_TYPE_PATCH`로 설정합니다.
    4.  **PSO 생성:** `CreateGraphicsPipelineState`를 호출하여 PSO를 생성하고, 반환되는 `HRESULT` 값을 체크하여 오류 발생 시 로그를 남깁니다.

**Step 4: 상수 버퍼 및 리소스 관리**
*   **목표:** 셰이더에서 사용할 데이터(테셀레이션 계수, 높이 맵)를 정확히 바인딩합니다.
*   **수행 작업:**
    1.  **상수 버퍼 생성:** 테셀레이션 계수(최소/최대 거리, 최소/최대 계수)를 담을 새로운 상수 버퍼를 C++ 코드에서 생성하고, 셰이더의 해당 레지스터(`b8` 등)에 바인딩합니다.
    2.  **리소스 바인딩 확인:** 도메인 셰이더가 높이 맵 텍스처를 정확히 참조할 수 있도록, C++의 SRV 생성 코드와 HLSL의 텍스처 레지스터(`t16` 등)가 일치하는지 다시 한번 확인합니다.